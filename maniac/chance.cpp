#include <string.h>
#include <stdint.h>

#include "chance.h"

void build_table(uint16_t *zero_state, uint16_t *one_state, size_t size, int factor, unsigned int max_p)
{
    const int64_t one = 1LL << 32;
    int64_t p;
    unsigned int last_p8, p8;
    unsigned int i;

    memset(zero_state,0,sizeof(uint16_t) * size);
    memset(one_state,0,sizeof(uint16_t) * size);

    last_p8 = 0;
    p = one / 2;
    for (i = 0; i < size / 2; i++) {
        p8 = (size * p + one / 2) >> 32; //FIXME try without the one
        if (p8 <= last_p8) p8 = last_p8 + 1;
        if (last_p8 && last_p8 < size && p8 <= max_p) one_state[last_p8] = p8;

        p += ((one - p) * factor + one / 2) >> 32;
        last_p8 = p8;
    }

    for (i = size - max_p; i <= max_p; i++) {
        if (one_state[i]) continue;

        p = (i * one + size / 2) / size;
        p += ((one - p) * factor + one / 2) >> 32;
        p8 = (size * p + one / 2) >> 32; //FIXME try without the one
        if (p8 <= i) p8 = i + 1;
        if (p8 > max_p) p8 = max_p;
        one_state[i] = p8;
    }

    for (i = 1; i < size; i++)
        zero_state[i] = size - one_state[size - i];

    /*  for (int i=0; i<size; i++) {
        e_printf("%i -> [%i,%i]\n",i,zero_state[i],one_state[i]);
      } */
}

const uint16_t log4k[4097] = { 0
        ,65535,60074,56879,54613,52854,51418,50203,49151,48223,47393,46642,45957
        ,45326,44742,44198,43690,43212,42762,42336,41932,41547,41181,40831,40495
        ,40174,39865,39567,39281,39004,38737,38479,38229,37986,37751,37523,37301
        ,37085,36875,36670,36471,36276,36086,35901,35720,35543,35369,35200,35034
        ,34872,34712,34556,34403,34253,34106,33962,33820,33680,33543,33408,33276
        ,33146,33018,32892,32768,32645,32525,32407,32290,32175,32061,31950,31839
        ,31731,31624,31518,31414,31311,31209,31108,31009,30911,30815,30719,30625
        ,30532,30440,30348,30258,30169,30081,29994,29908,29823,29739,29655,29573
        ,29491,29410,29330,29251,29173,29095,29018,28942,28867,28792,28718,28645
        ,28572,28500,28429,28358,28288,28219,28150,28082,28014,27947,27881,27815
        ,27749,27685,27620,27556,27493,27430,27368,27306,27245,27184,27124,27064
        ,27004,26945,26887,26829,26771,26714,26657,26600,26544,26488,26433,26378
        ,26324,26270,26216,26162,26109,26057,26004,25952,25901,25849,25798,25748
        ,25697,25647,25598,25548,25499,25450,25402,25354,25306,25258,25211,25164
        ,25117,25070,25024,24978,24933,24887,24842,24797,24753,24708,24664,24620
        ,24576,24533,24490,24447,24404,24362,24320,24278,24236,24194,24153,24112
        ,24071,24030,23989,23949,23909,23869,23829,23790,23751,23712,23673,23634
        ,23595,23557,23519,23481,23443,23406,23368,23331,23294,23257,23220,23184
        ,23147,23111,23075,23039,23003,22968,22932,22897,22862,22827,22792,22758
        ,22723,22689,22655,22621,22587,22553,22519,22486,22453,22419,22386,22353
        ,22321,22288,22256,22223,22191,22159,22127,22095,22063,22032,22000,21969
        ,21938,21907,21876,21845,21814,21784,21753,21723,21693,21662,21632,21603
        ,21573,21543,21514,21484,21455,21425,21396,21367,21338,21310,21281,21252
        ,21224,21195,21167,21139,21111,21083,21055,21027,20999,20972,20944,20917
        ,20890,20862,20835,20808,20781,20755,20728,20701,20675,20648,20622,20595
        ,20569,20543,20517,20491,20465,20439,20414,20388,20362,20337,20312,20286
        ,20261,20236,20211,20186,20161,20136,20112,20087,20062,20038,20013,19989
        ,19965,19941,19916,19892,19868,19844,19821,19797,19773,19749,19726,19702
        ,19679,19656,19632,19609,19586,19563,19540,19517,19494,19471,19449,19426
        ,19403,19381,19358,19336,19314,19291,19269,19247,19225,19203,19181,19159
        ,19137,19115,19093,19072,19050,19029,19007,18986,18964,18943,18922,18901
        ,18879,18858,18837,18816,18795,18774,18754,18733,18712,18692,18671,18650
        ,18630,18609,18589,18569,18548,18528,18508,18488,18468,18448,18428,18408
        ,18388,18368,18348,18329,18309,18289,18270,18250,18231,18211,18192,18173
        ,18153,18134,18115,18096,18077,18058,18039,18020,18001,17982,17963,17944
        ,17926,17907,17888,17870,17851,17833,17814,17796,17777,17759,17741,17722
        ,17704,17686,17668,17650,17632,17614,17596,17578,17560,17542,17524,17506
        ,17489,17471,17453,17436,17418,17401,17383,17366,17348,17331,17314,17296
        ,17279,17262,17245,17228,17210,17193,17176,17159,17142,17125,17109,17092
        ,17075,17058,17041,17025,17008,16991,16975,16958,16942,16925,16909,16892
        ,16876,16859,16843,16827,16811,16794,16778,16762,16746,16730,16714,16698
        ,16682,16666,16650,16634,16618,16602,16586,16571,16555,16539,16523,16508
        ,16492,16477,16461,16446,16430,16415,16399,16384,16368,16353,16338,16322
        ,16307,16292,16277,16262,16246,16231,16216,16201,16186,16171,16156,16141
        ,16126,16112,16097,16082,16067,16052,16038,16023,16008,15993,15979,15964
        ,15950,15935,15921,15906,15892,15877,15863,15848,15834,15820,15805,15791
        ,15777,15763,15748,15734,15720,15706,15692,15678,15664,15650,15636,15622
        ,15608,15594,15580,15566,15552,15538,15524,15511,15497,15483,15469,15456
        ,15442,15428,15415,15401,15388,15374,15361,15347,15334,15320,15307,15293
        ,15280,15267,15253,15240,15227,15213,15200,15187,15174,15160,15147,15134
        ,15121,15108,15095,15082,15069,15056,15043,15030,15017,15004,14991,14978
        ,14965,14952,14940,14927,14914,14901,14888,14876,14863,14850,14838,14825
        ,14812,14800,14787,14775,14762,14750,14737,14725,14712,14700,14687,14675
        ,14663,14650,14638,14626,14613,14601,14589,14577,14564,14552,14540,14528
        ,14516,14503,14491,14479,14467,14455,14443,14431,14419,14407,14395,14383
        ,14371,14359,14347,14336,14324,14312,14300,14288,14276,14265,14253,14241
        ,14229,14218,14206,14194,14183,14171,14160,14148,14136,14125,14113,14102
        ,14090,14079,14067,14056,14044,14033,14022,14010,13999,13987,13976,13965
        ,13953,13942,13931,13920,13908,13897,13886,13875,13863,13852,13841,13830
        ,13819,13808,13797,13786,13775,13764,13753,13742,13731,13720,13709,13698
        ,13687,13676,13665,13654,13643,13632,13621,13611,13600,13589,13578,13567
        ,13557,13546,13535,13524,13514,13503,13492,13482,13471,13460,13450,13439
        ,13429,13418,13408,13397,13386,13376,13365,13355,13345,13334,13324,13313
        ,13303,13292,13282,13272,13261,13251,13241,13230,13220,13210,13199,13189
        ,13179,13169,13158,13148,13138,13128,13118,13107,13097,13087,13077,13067
        ,13057,13047,13037,13027,13017,13007,12997,12987,12977,12967,12957,12947
        ,12937,12927,12917,12907,12897,12887,12877,12867,12858,12848,12838,12828
        ,12818,12809,12799,12789,12779,12770,12760,12750,12740,12731,12721,12711
        ,12702,12692,12683,12673,12663,12654,12644,12635,12625,12615,12606,12596
        ,12587,12577,12568,12558,12549,12540,12530,12521,12511,12502,12492,12483
        ,12474,12464,12455,12446,12436,12427,12418,12408,12399,12390,12381,12371
        ,12362,12353,12344,12334,12325,12316,12307,12298,12289,12279,12270,12261
        ,12252,12243,12234,12225,12216,12207,12198,12189,12179,12170,12161,12152
        ,12143,12134,12126,12117,12108,12099,12090,12081,12072,12063,12054,12045
        ,12036,12028,12019,12010,12001,11992,11983,11975,11966,11957,11948,11939
        ,11931,11922,11913,11905,11896,11887,11878,11870,11861,11852,11844,11835
        ,11826,11818,11809,11801,11792,11783,11775,11766,11758,11749,11741,11732
        ,11724,11715,11707,11698,11690,11681,11673,11664,11656,11647,11639,11630
        ,11622,11614,11605,11597,11588,11580,11572,11563,11555,11547,11538,11530
        ,11522,11513,11505,11497,11489,11480,11472,11464,11456,11447,11439,11431
        ,11423,11415,11406,11398,11390,11382,11374,11366,11357,11349,11341,11333
        ,11325,11317,11309,11301,11293,11285,11277,11269,11261,11252,11244,11236
        ,11228,11220,11212,11204,11197,11189,11181,11173,11165,11157,11149,11141
        ,11133,11125,11117,11109,11101,11094,11086,11078,11070,11062,11054,11047
        ,11039,11031,11023,11015,11008,11000,10992,10984,10977,10969,10961,10953
        ,10946,10938,10930,10923,10915,10907,10899,10892,10884,10876,10869,10861
        ,10854,10846,10838,10831,10823,10816,10808,10800,10793,10785,10778,10770
        ,10763,10755,10747,10740,10732,10725,10717,10710,10702,10695,10688,10680
        ,10673,10665,10658,10650,10643,10635,10628,10621,10613,10606,10598,10591
        ,10584,10576,10569,10562,10554,10547,10540,10532,10525,10518,10510,10503
        ,10496,10488,10481,10474,10467,10459,10452,10445,10438,10430,10423,10416
        ,10409,10402,10394,10387,10380,10373,10366,10358,10351,10344,10337,10330
        ,10323,10316,10308,10301,10294,10287,10280,10273,10266,10259,10252,10245
        ,10238,10231,10223,10216,10209,10202,10195,10188,10181,10174,10167,10160
        ,10153,10146,10139,10132,10126,10119,10112,10105,10098,10091,10084,10077
        ,10070,10063,10056,10049,10043,10036,10029,10022,10015,10008,10001, 9994
        , 9988, 9981, 9974, 9967, 9960, 9954, 9947, 9940, 9933, 9926, 9920, 9913
        , 9906, 9899, 9893, 9886, 9879, 9872, 9866, 9859, 9852, 9845, 9839, 9832
        , 9825, 9819, 9812, 9805, 9799, 9792, 9785, 9779, 9772, 9765, 9759, 9752
        , 9745, 9739, 9732, 9726, 9719, 9712, 9706, 9699, 9693, 9686, 9679, 9673
        , 9666, 9660, 9653, 9647, 9640, 9634, 9627, 9621, 9614, 9607, 9601, 9594
        , 9588, 9581, 9575, 9569, 9562, 9556, 9549, 9543, 9536, 9530, 9523, 9517
        , 9510, 9504, 9498, 9491, 9485, 9478, 9472, 9466, 9459, 9453, 9446, 9440
        , 9434, 9427, 9421, 9415, 9408, 9402, 9395, 9389, 9383, 9376, 9370, 9364
        , 9358, 9351, 9345, 9339, 9332, 9326, 9320, 9314, 9307, 9301, 9295, 9288
        , 9282, 9276, 9270, 9263, 9257, 9251, 9245, 9239, 9232, 9226, 9220, 9214
        , 9208, 9201, 9195, 9189, 9183, 9177, 9171, 9164, 9158, 9152, 9146, 9140
        , 9134, 9128, 9121, 9115, 9109, 9103, 9097, 9091, 9085, 9079, 9073, 9066
        , 9060, 9054, 9048, 9042, 9036, 9030, 9024, 9018, 9012, 9006, 9000, 8994
        , 8988, 8982, 8976, 8970, 8964, 8958, 8952, 8946, 8940, 8934, 8928, 8922
        , 8916, 8910, 8904, 8898, 8892, 8886, 8880, 8874, 8868, 8862, 8857, 8851
        , 8845, 8839, 8833, 8827, 8821, 8815, 8809, 8803, 8798, 8792, 8786, 8780
        , 8774, 8768, 8762, 8757, 8751, 8745, 8739, 8733, 8727, 8722, 8716, 8710
        , 8704, 8698, 8693, 8687, 8681, 8675, 8669, 8664, 8658, 8652, 8646, 8641
        , 8635, 8629, 8623, 8617, 8612, 8606, 8600, 8595, 8589, 8583, 8577, 8572
        , 8566, 8560, 8555, 8549, 8543, 8538, 8532, 8526, 8520, 8515, 8509, 8503
        , 8498, 8492, 8487, 8481, 8475, 8470, 8464, 8458, 8453, 8447, 8441, 8436
        , 8430, 8425, 8419, 8413, 8408, 8402, 8397, 8391, 8385, 8380, 8374, 8369
        , 8363, 8358, 8352, 8347, 8341, 8335, 8330, 8324, 8319, 8313, 8308, 8302
        , 8297, 8291, 8286, 8280, 8275, 8269, 8264, 8258, 8253, 8247, 8242, 8236
        , 8231, 8225, 8220, 8215, 8209, 8204, 8198, 8193, 8187, 8182, 8176, 8171
        , 8166, 8160, 8155, 8149, 8144, 8138, 8133, 8128, 8122, 8117, 8112, 8106
        , 8101, 8095, 8090, 8085, 8079, 8074, 8069, 8063, 8058, 8052, 8047, 8042
        , 8036, 8031, 8026, 8020, 8015, 8010, 8005, 7999, 7994, 7989, 7983, 7978
        , 7973, 7967, 7962, 7957, 7952, 7946, 7941, 7936, 7931, 7925, 7920, 7915
        , 7909, 7904, 7899, 7894, 7889, 7883, 7878, 7873, 7868, 7862, 7857, 7852
        , 7847, 7842, 7836, 7831, 7826, 7821, 7816, 7810, 7805, 7800, 7795, 7790
        , 7785, 7779, 7774, 7769, 7764, 7759, 7754, 7748, 7743, 7738, 7733, 7728
        , 7723, 7718, 7713, 7707, 7702, 7697, 7692, 7687, 7682, 7677, 7672, 7667
        , 7661, 7656, 7651, 7646, 7641, 7636, 7631, 7626, 7621, 7616, 7611, 7606
        , 7601, 7596, 7591, 7586, 7581, 7575, 7570, 7565, 7560, 7555, 7550, 7545
        , 7540, 7535, 7530, 7525, 7520, 7515, 7510, 7505, 7500, 7495, 7490, 7485
        , 7480, 7475, 7471, 7466, 7461, 7456, 7451, 7446, 7441, 7436, 7431, 7426
        , 7421, 7416, 7411, 7406, 7401, 7396, 7391, 7387, 7382, 7377, 7372, 7367
        , 7362, 7357, 7352, 7347, 7342, 7338, 7333, 7328, 7323, 7318, 7313, 7308
        , 7304, 7299, 7294, 7289, 7284, 7279, 7274, 7270, 7265, 7260, 7255, 7250
        , 7245, 7241, 7236, 7231, 7226, 7221, 7216, 7212, 7207, 7202, 7197, 7192
        , 7188, 7183, 7178, 7173, 7169, 7164, 7159, 7154, 7149, 7145, 7140, 7135
        , 7130, 7126, 7121, 7116, 7111, 7107, 7102, 7097, 7092, 7088, 7083, 7078
        , 7074, 7069, 7064, 7059, 7055, 7050, 7045, 7041, 7036, 7031, 7027, 7022
        , 7017, 7012, 7008, 7003, 6998, 6994, 6989, 6984, 6980, 6975, 6970, 6966
        , 6961, 6956, 6952, 6947, 6943, 6938, 6933, 6929, 6924, 6919, 6915, 6910
        , 6905, 6901, 6896, 6892, 6887, 6882, 6878, 6873, 6869, 6864, 6859, 6855
        , 6850, 6846, 6841, 6836, 6832, 6827, 6823, 6818, 6814, 6809, 6804, 6800
        , 6795, 6791, 6786, 6782, 6777, 6773, 6768, 6763, 6759, 6754, 6750, 6745
        , 6741, 6736, 6732, 6727, 6723, 6718, 6714, 6709, 6705, 6700, 6696, 6691
        , 6687, 6682, 6678, 6673, 6669, 6664, 6660, 6655, 6651, 6646, 6642, 6637
        , 6633, 6628, 6624, 6620, 6615, 6611, 6606, 6602, 6597, 6593, 6588, 6584
        , 6580, 6575, 6571, 6566, 6562, 6557, 6553, 6549, 6544, 6540, 6535, 6531
        , 6527, 6522, 6518, 6513, 6509, 6505, 6500, 6496, 6491, 6487, 6483, 6478
        , 6474, 6469, 6465, 6461, 6456, 6452, 6448, 6443, 6439, 6435, 6430, 6426
        , 6422, 6417, 6413, 6409, 6404, 6400, 6396, 6391, 6387, 6383, 6378, 6374
        , 6370, 6365, 6361, 6357, 6352, 6348, 6344, 6339, 6335, 6331, 6327, 6322
        , 6318, 6314, 6309, 6305, 6301, 6297, 6292, 6288, 6284, 6279, 6275, 6271
        , 6267, 6262, 6258, 6254, 6250, 6245, 6241, 6237, 6233, 6228, 6224, 6220
        , 6216, 6211, 6207, 6203, 6199, 6195, 6190, 6186, 6182, 6178, 6173, 6169
        , 6165, 6161, 6157, 6152, 6148, 6144, 6140, 6136, 6131, 6127, 6123, 6119
        , 6115, 6111, 6106, 6102, 6098, 6094, 6090, 6085, 6081, 6077, 6073, 6069
        , 6065, 6061, 6056, 6052, 6048, 6044, 6040, 6036, 6032, 6027, 6023, 6019
        , 6015, 6011, 6007, 6003, 5999, 5994, 5990, 5986, 5982, 5978, 5974, 5970
        , 5966, 5962, 5957, 5953, 5949, 5945, 5941, 5937, 5933, 5929, 5925, 5921
        , 5917, 5913, 5908, 5904, 5900, 5896, 5892, 5888, 5884, 5880, 5876, 5872
        , 5868, 5864, 5860, 5856, 5852, 5848, 5844, 5840, 5835, 5831, 5827, 5823
        , 5819, 5815, 5811, 5807, 5803, 5799, 5795, 5791, 5787, 5783, 5779, 5775
        , 5771, 5767, 5763, 5759, 5755, 5751, 5747, 5743, 5739, 5735, 5731, 5727
        , 5723, 5719, 5715, 5711, 5707, 5703, 5699, 5696, 5692, 5688, 5684, 5680
        , 5676, 5672, 5668, 5664, 5660, 5656, 5652, 5648, 5644, 5640, 5636, 5632
        , 5628, 5625, 5621, 5617, 5613, 5609, 5605, 5601, 5597, 5593, 5589, 5585
        , 5581, 5578, 5574, 5570, 5566, 5562, 5558, 5554, 5550, 5546, 5542, 5539
        , 5535, 5531, 5527, 5523, 5519, 5515, 5511, 5508, 5504, 5500, 5496, 5492
        , 5488, 5484, 5481, 5477, 5473, 5469, 5465, 5461, 5457, 5454, 5450, 5446
        , 5442, 5438, 5434, 5431, 5427, 5423, 5419, 5415, 5411, 5408, 5404, 5400
        , 5396, 5392, 5388, 5385, 5381, 5377, 5373, 5369, 5366, 5362, 5358, 5354
        , 5350, 5347, 5343, 5339, 5335, 5332, 5328, 5324, 5320, 5316, 5313, 5309
        , 5305, 5301, 5298, 5294, 5290, 5286, 5282, 5279, 5275, 5271, 5267, 5264
        , 5260, 5256, 5252, 5249, 5245, 5241, 5237, 5234, 5230, 5226, 5223, 5219
        , 5215, 5211, 5208, 5204, 5200, 5196, 5193, 5189, 5185, 5182, 5178, 5174
        , 5170, 5167, 5163, 5159, 5156, 5152, 5148, 5145, 5141, 5137, 5133, 5130
        , 5126, 5122, 5119, 5115, 5111, 5108, 5104, 5100, 5097, 5093, 5089, 5086
        , 5082, 5078, 5075, 5071, 5067, 5064, 5060, 5056, 5053, 5049, 5045, 5042
        , 5038, 5034, 5031, 5027, 5024, 5020, 5016, 5013, 5009, 5005, 5002, 4998
        , 4994, 4991, 4987, 4984, 4980, 4976, 4973, 4969, 4966, 4962, 4958, 4955
        , 4951, 4947, 4944, 4940, 4937, 4933, 4929, 4926, 4922, 4919, 4915, 4912
        , 4908, 4904, 4901, 4897, 4894, 4890, 4886, 4883, 4879, 4876, 4872, 4869
        , 4865, 4861, 4858, 4854, 4851, 4847, 4844, 4840, 4837, 4833, 4829, 4826
        , 4822, 4819, 4815, 4812, 4808, 4805, 4801, 4798, 4794, 4790, 4787, 4783
        , 4780, 4776, 4773, 4769, 4766, 4762, 4759, 4755, 4752, 4748, 4745, 4741
        , 4738, 4734, 4731, 4727, 4724, 4720, 4717, 4713, 4710, 4706, 4703, 4699
        , 4696, 4692, 4689, 4685, 4682, 4678, 4675, 4671, 4668, 4664, 4661, 4657
        , 4654, 4650, 4647, 4643, 4640, 4637, 4633, 4630, 4626, 4623, 4619, 4616
        , 4612, 4609, 4605, 4602, 4598, 4595, 4592, 4588, 4585, 4581, 4578, 4574
        , 4571, 4568, 4564, 4561, 4557, 4554, 4550, 4547, 4544, 4540, 4537, 4533
        , 4530, 4526, 4523, 4520, 4516, 4513, 4509, 4506, 4503, 4499, 4496, 4492
        , 4489, 4486, 4482, 4479, 4475, 4472, 4469, 4465, 4462, 4458, 4455, 4452
        , 4448, 4445, 4441, 4438, 4435, 4431, 4428, 4425, 4421, 4418, 4414, 4411
        , 4408, 4404, 4401, 4398, 4394, 4391, 4388, 4384, 4381, 4377, 4374, 4371
        , 4367, 4364, 4361, 4357, 4354, 4351, 4347, 4344, 4341, 4337, 4334, 4331
        , 4327, 4324, 4321, 4317, 4314, 4311, 4307, 4304, 4301, 4297, 4294, 4291
        , 4287, 4284, 4281, 4278, 4274, 4271, 4268, 4264, 4261, 4258, 4254, 4251
        , 4248, 4245, 4241, 4238, 4235, 4231, 4228, 4225, 4221, 4218, 4215, 4212
        , 4208, 4205, 4202, 4198, 4195, 4192, 4189, 4185, 4182, 4179, 4176, 4172
        , 4169, 4166, 4163, 4159, 4156, 4153, 4149, 4146, 4143, 4140, 4136, 4133
        , 4130, 4127, 4123, 4120, 4117, 4114, 4110, 4107, 4104, 4101, 4098, 4094
        , 4091, 4088, 4085, 4081, 4078, 4075, 4072, 4068, 4065, 4062, 4059, 4056
        , 4052, 4049, 4046, 4043, 4040, 4036, 4033, 4030, 4027, 4023, 4020, 4017
        , 4014, 4011, 4007, 4004, 4001, 3998, 3995, 3991, 3988, 3985, 3982, 3979
        , 3976, 3972, 3969, 3966, 3963, 3960, 3956, 3953, 3950, 3947, 3944, 3941
        , 3937, 3934, 3931, 3928, 3925, 3922, 3918, 3915, 3912, 3909, 3906, 3903
        , 3899, 3896, 3893, 3890, 3887, 3884, 3881, 3877, 3874, 3871, 3868, 3865
        , 3862, 3859, 3855, 3852, 3849, 3846, 3843, 3840, 3837, 3833, 3830, 3827
        , 3824, 3821, 3818, 3815, 3812, 3808, 3805, 3802, 3799, 3796, 3793, 3790
        , 3787, 3784, 3780, 3777, 3774, 3771, 3768, 3765, 3762, 3759, 3756, 3753
        , 3749, 3746, 3743, 3740, 3737, 3734, 3731, 3728, 3725, 3722, 3719, 3715
        , 3712, 3709, 3706, 3703, 3700, 3697, 3694, 3691, 3688, 3685, 3682, 3679
        , 3675, 3672, 3669, 3666, 3663, 3660, 3657, 3654, 3651, 3648, 3645, 3642
        , 3639, 3636, 3633, 3630, 3627, 3624, 3620, 3617, 3614, 3611, 3608, 3605
        , 3602, 3599, 3596, 3593, 3590, 3587, 3584, 3581, 3578, 3575, 3572, 3569
        , 3566, 3563, 3560, 3557, 3554, 3551, 3548, 3545, 3542, 3539, 3536, 3533
        , 3530, 3527, 3524, 3521, 3518, 3515, 3512, 3509, 3506, 3503, 3500, 3497
        , 3494, 3491, 3488, 3485, 3482, 3479, 3476, 3473, 3470, 3467, 3464, 3461
        , 3458, 3455, 3452, 3449, 3446, 3443, 3440, 3437, 3434, 3431, 3428, 3425
        , 3422, 3419, 3416, 3413, 3410, 3407, 3404, 3401, 3398, 3395, 3392, 3389
        , 3386, 3383, 3381, 3378, 3375, 3372, 3369, 3366, 3363, 3360, 3357, 3354
        , 3351, 3348, 3345, 3342, 3339, 3336, 3333, 3330, 3328, 3325, 3322, 3319
        , 3316, 3313, 3310, 3307, 3304, 3301, 3298, 3295, 3292, 3289, 3287, 3284
        , 3281, 3278, 3275, 3272, 3269, 3266, 3263, 3260, 3257, 3254, 3252, 3249
        , 3246, 3243, 3240, 3237, 3234, 3231, 3228, 3225, 3223, 3220, 3217, 3214
        , 3211, 3208, 3205, 3202, 3199, 3197, 3194, 3191, 3188, 3185, 3182, 3179
        , 3176, 3173, 3171, 3168, 3165, 3162, 3159, 3156, 3153, 3151, 3148, 3145
        , 3142, 3139, 3136, 3133, 3130, 3128, 3125, 3122, 3119, 3116, 3113, 3110
        , 3108, 3105, 3102, 3099, 3096, 3093, 3090, 3088, 3085, 3082, 3079, 3076
        , 3073, 3071, 3068, 3065, 3062, 3059, 3056, 3054, 3051, 3048, 3045, 3042
        , 3039, 3037, 3034, 3031, 3028, 3025, 3022, 3020, 3017, 3014, 3011, 3008
        , 3006, 3003, 3000, 2997, 2994, 2991, 2989, 2986, 2983, 2980, 2977, 2975
        , 2972, 2969, 2966, 2963, 2961, 2958, 2955, 2952, 2949, 2947, 2944, 2941
        , 2938, 2935, 2933, 2930, 2927, 2924, 2921, 2919, 2916, 2913, 2910, 2908
        , 2905, 2902, 2899, 2896, 2894, 2891, 2888, 2885, 2883, 2880, 2877, 2874
        , 2871, 2869, 2866, 2863, 2860, 2858, 2855, 2852, 2849, 2847, 2844, 2841
        , 2838, 2836, 2833, 2830, 2827, 2825, 2822, 2819, 2816, 2814, 2811, 2808
        , 2805, 2803, 2800, 2797, 2794, 2792, 2789, 2786, 2783, 2781, 2778, 2775
        , 2772, 2770, 2767, 2764, 2761, 2759, 2756, 2753, 2751, 2748, 2745, 2742
        , 2740, 2737, 2734, 2731, 2729, 2726, 2723, 2721, 2718, 2715, 2712, 2710
        , 2707, 2704, 2702, 2699, 2696, 2693, 2691, 2688, 2685, 2683, 2680, 2677
        , 2675, 2672, 2669, 2666, 2664, 2661, 2658, 2656, 2653, 2650, 2648, 2645
        , 2642, 2640, 2637, 2634, 2631, 2629, 2626, 2623, 2621, 2618, 2615, 2613
        , 2610, 2607, 2605, 2602, 2599, 2597, 2594, 2591, 2589, 2586, 2583, 2581
        , 2578, 2575, 2573, 2570, 2567, 2565, 2562, 2559, 2557, 2554, 2551, 2549
        , 2546, 2543, 2541, 2538, 2535, 2533, 2530, 2527, 2525, 2522, 2519, 2517
        , 2514, 2511, 2509, 2506, 2504, 2501, 2498, 2496, 2493, 2490, 2488, 2485
        , 2482, 2480, 2477, 2475, 2472, 2469, 2467, 2464, 2461, 2459, 2456, 2453
        , 2451, 2448, 2446, 2443, 2440, 2438, 2435, 2433, 2430, 2427, 2425, 2422
        , 2419, 2417, 2414, 2412, 2409, 2406, 2404, 2401, 2399, 2396, 2393, 2391
        , 2388, 2385, 2383, 2380, 2378, 2375, 2372, 2370, 2367, 2365, 2362, 2359
        , 2357, 2354, 2352, 2349, 2347, 2344, 2341, 2339, 2336, 2334, 2331, 2328
        , 2326, 2323, 2321, 2318, 2316, 2313, 2310, 2308, 2305, 2303, 2300, 2297
        , 2295, 2292, 2290, 2287, 2285, 2282, 2279, 2277, 2274, 2272, 2269, 2267
        , 2264, 2261, 2259, 2256, 2254, 2251, 2249, 2246, 2244, 2241, 2238, 2236
        , 2233, 2231, 2228, 2226, 2223, 2221, 2218, 2215, 2213, 2210, 2208, 2205
        , 2203, 2200, 2198, 2195, 2193, 2190, 2188, 2185, 2182, 2180, 2177, 2175
        , 2172, 2170, 2167, 2165, 2162, 2160, 2157, 2155, 2152, 2150, 2147, 2144
        , 2142, 2139, 2137, 2134, 2132, 2129, 2127, 2124, 2122, 2119, 2117, 2114
        , 2112, 2109, 2107, 2104, 2102, 2099, 2097, 2094, 2092, 2089, 2087, 2084
        , 2082, 2079, 2077, 2074, 2072, 2069, 2067, 2064, 2062, 2059, 2057, 2054
        , 2052, 2049, 2047, 2044, 2042, 2039, 2037, 2034, 2032, 2029, 2027, 2024
        , 2022, 2019, 2017, 2014, 2012, 2009, 2007, 2004, 2002, 1999, 1997, 1994
        , 1992, 1989, 1987, 1984, 1982, 1980, 1977, 1975, 1972, 1970, 1967, 1965
        , 1962, 1960, 1957, 1955, 1952, 1950, 1947, 1945, 1943, 1940, 1938, 1935
        , 1933, 1930, 1928, 1925, 1923, 1920, 1918, 1915, 1913, 1911, 1908, 1906
        , 1903, 1901, 1898, 1896, 1893, 1891, 1889, 1886, 1884, 1881, 1879, 1876
        , 1874, 1871, 1869, 1867, 1864, 1862, 1859, 1857, 1854, 1852, 1850, 1847
        , 1845, 1842, 1840, 1837, 1835, 1833, 1830, 1828, 1825, 1823, 1820, 1818
        , 1816, 1813, 1811, 1808, 1806, 1803, 1801, 1799, 1796, 1794, 1791, 1789
        , 1787, 1784, 1782, 1779, 1777, 1774, 1772, 1770, 1767, 1765, 1762, 1760
        , 1758, 1755, 1753, 1750, 1748, 1746, 1743, 1741, 1738, 1736, 1734, 1731
        , 1729, 1726, 1724, 1722, 1719, 1717, 1714, 1712, 1710, 1707, 1705, 1703
        , 1700, 1698, 1695, 1693, 1691, 1688, 1686, 1683, 1681, 1679, 1676, 1674
        , 1672, 1669, 1667, 1664, 1662, 1660, 1657, 1655, 1653, 1650, 1648, 1645
        , 1643, 1641, 1638, 1636, 1634, 1631, 1629, 1627, 1624, 1622, 1619, 1617
        , 1615, 1612, 1610, 1608, 1605, 1603, 1601, 1598, 1596, 1593, 1591, 1589
        , 1586, 1584, 1582, 1579, 1577, 1575, 1572, 1570, 1568, 1565, 1563, 1561
        , 1558, 1556, 1554, 1551, 1549, 1547, 1544, 1542, 1540, 1537, 1535, 1532
        , 1530, 1528, 1525, 1523, 1521, 1518, 1516, 1514, 1511, 1509, 1507, 1504
        , 1502, 1500, 1498, 1495, 1493, 1491, 1488, 1486, 1484, 1481, 1479, 1477
        , 1474, 1472, 1470, 1467, 1465, 1463, 1460, 1458, 1456, 1453, 1451, 1449
        , 1447, 1444, 1442, 1440, 1437, 1435, 1433, 1430, 1428, 1426, 1423, 1421
        , 1419, 1417, 1414, 1412, 1410, 1407, 1405, 1403, 1400, 1398, 1396, 1394
        , 1391, 1389, 1387, 1384, 1382, 1380, 1377, 1375, 1373, 1371, 1368, 1366
        , 1364, 1361, 1359, 1357, 1355, 1352, 1350, 1348, 1345, 1343, 1341, 1339
        , 1336, 1334, 1332, 1330, 1327, 1325, 1323, 1320, 1318, 1316, 1314, 1311
        , 1309, 1307, 1304, 1302, 1300, 1298, 1295, 1293, 1291, 1289, 1286, 1284
        , 1282, 1280, 1277, 1275, 1273, 1271, 1268, 1266, 1264, 1261, 1259, 1257
        , 1255, 1252, 1250, 1248, 1246, 1243, 1241, 1239, 1237, 1234, 1232, 1230
        , 1228, 1225, 1223, 1221, 1219, 1216, 1214, 1212, 1210, 1207, 1205, 1203
        , 1201, 1199, 1196, 1194, 1192, 1190, 1187, 1185, 1183, 1181, 1178, 1176
        , 1174, 1172, 1169, 1167, 1165, 1163, 1161, 1158, 1156, 1154, 1152, 1149
        , 1147, 1145, 1143, 1141, 1138, 1136, 1134, 1132, 1129, 1127, 1125, 1123
        , 1121, 1118, 1116, 1114, 1112, 1109, 1107, 1105, 1103, 1101, 1098, 1096
        , 1094, 1092, 1090, 1087, 1085, 1083, 1081, 1079, 1076, 1074, 1072, 1070
        , 1067, 1065, 1063, 1061, 1059, 1056, 1054, 1052, 1050, 1048, 1045, 1043
        , 1041, 1039, 1037, 1035, 1032, 1030, 1028, 1026, 1024, 1021, 1019, 1017
        , 1015, 1013, 1010, 1008, 1006, 1004, 1002,  999,  997,  995,  993,  991
        ,  989,  986,  984,  982,  980,  978,  976,  973,  971,  969,  967,  965
        ,  962,  960,  958,  956,  954,  952,  949,  947,  945,  943,  941,  939
        ,  936,  934,  932,  930,  928,  926,  923,  921,  919,  917,  915,  913
        ,  910,  908,  906,  904,  902,  900,  898,  895,  893,  891,  889,  887
        ,  885,  882,  880,  878,  876,  874,  872,  870,  867,  865,  863,  861
        ,  859,  857,  855,  852,  850,  848,  846,  844,  842,  840,  837,  835
        ,  833,  831,  829,  827,  825,  822,  820,  818,  816,  814,  812,  810
        ,  808,  805,  803,  801,  799,  797,  795,  793,  790,  788,  786,  784
        ,  782,  780,  778,  776,  773,  771,  769,  767,  765,  763,  761,  759
        ,  757,  754,  752,  750,  748,  746,  744,  742,  740,  737,  735,  733
        ,  731,  729,  727,  725,  723,  721,  718,  716,  714,  712,  710,  708
        ,  706,  704,  702,  700,  697,  695,  693,  691,  689,  687,  685,  683
        ,  681,  679,  676,  674,  672,  670,  668,  666,  664,  662,  660,  658
        ,  656,  653,  651,  649,  647,  645,  643,  641,  639,  637,  635,  633
        ,  630,  628,  626,  624,  622,  620,  618,  616,  614,  612,  610,  608
        ,  606,  603,  601,  599,  597,  595,  593,  591,  589,  587,  585,  583
        ,  581,  579,  576,  574,  572,  570,  568,  566,  564,  562,  560,  558
        ,  556,  554,  552,  550,  548,  546,  543,  541,  539,  537,  535,  533
        ,  531,  529,  527,  525,  523,  521,  519,  517,  515,  513,  511,  508
        ,  506,  504,  502,  500,  498,  496,  494,  492,  490,  488,  486,  484
        ,  482,  480,  478,  476,  474,  472,  470,  468,  466,  463,  461,  459
        ,  457,  455,  453,  451,  449,  447,  445,  443,  441,  439,  437,  435
        ,  433,  431,  429,  427,  425,  423,  421,  419,  417,  415,  413,  411
        ,  409,  407,  405,  403,  400,  398,  396,  394,  392,  390,  388,  386
        ,  384,  382,  380,  378,  376,  374,  372,  370,  368,  366,  364,  362
        ,  360,  358,  356,  354,  352,  350,  348,  346,  344,  342,  340,  338
        ,  336,  334,  332,  330,  328,  326,  324,  322,  320,  318,  316,  314
        ,  312,  310,  308,  306,  304,  302,  300,  298,  296,  294,  292,  290
        ,  288,  286,  284,  282,  280,  278,  276,  274,  272,  270,  268,  266
        ,  264,  262,  260,  258,  256,  254,  252,  250,  248,  246,  244,  242
        ,  240,  238,  236,  234,  232,  230,  228,  226,  224,  222,  220,  218
        ,  216,  214,  213,  211,  209,  207,  205,  203,  201,  199,  197,  195
        ,  193,  191,  189,  187,  185,  183,  181,  179,  177,  175,  173,  171
        ,  169,  167,  165,  163,  161,  159,  157,  155,  153,  151,  150,  148
        ,  146,  144,  142,  140,  138,  136,  134,  132,  130,  128,  126,  124
        ,  122,  120,  118,  116,  114,  112,  110,  108,  107,  105,  103,  101
        ,   99,   97,   95,   93,   91,   89,   87,   85,   83,   81,   79,   77
        ,   75,   73,   71,   70,   68,   66,   64,   62,   60,   58,   56,   54
        ,   52,   50,   48,   46,   44,   42,   40,   39,   37,   35,   33,   31
        ,   29,   27,   25,   23,   21,   19,   17,   15,   13,   12,   10,    8
        ,    6,    4,    2,    0
                                              };

const int log4k_scale = 5461;
